{
  "improvement_classification_delta": {
    "comment": [
      "Delta-based generation: LLM generates code deltas instead of full code"
    ],
    "use_delta": true,
    "task": "img-classification",
    "addon_task": null,
    "num_joint_nns": 2,
    "improve": true,
    "input_list": [
      {"para": "nn_code", "value": "nn_code"},
      {"para": "accuracy", "value": "accuracy"},
      {"para": "epoch", "value": "epoch"},
      {"para": "dataset", "value": "dataset"},
      {"para": "task", "value": "task"},
      {"para": "metric", "value": "metric"},
      {"para": "transform_code", "value": "transform_code"},
      {"para": "prm", "value": "prm"},
      {"para": "addon_accuracy", "value": "accuracy_2"},
      {"para": "addon_epoch", "value": "epoch_2"},
      {"para": "addon_nn_code", "value": "nn_code_2"},
      {"para": "addon_transform_code", "value": "transform_code_2"},
      {"para": "addon_prm", "value": "prm_2"}
    ],
    "no_repeat": ["nn"],
    "keep_same": ["epoch", "metric", "dataset", "task"],
    "nn_prefixes": [],
    "prompt": [
      "Task: Generate a unified diff (delta) to improve the baseline model.",
      "",
      "=== BASELINE MODEL ===",
      "<hp>{prm}</hp>",
      "",
      "<tr>",
      "{transform_code}",
      "</tr>",
      "",
      "<nn>",
      "{nn_code}",
      "</nn>",
      "",
      "Current performance: {accuracy} at epoch {epoch}",
      "Goal: Maximize '{metric}' on '{dataset}' for '{task}'",
      "",
      "=== YOUR TASK ===",
      "1. READ the baseline code structure carefully (class names, layer names, method signatures)",
      "2. Generate a delta that MATCHES the baseline's actual structure",
      "3. Use the EXACT variable names from the baseline (e.g., if baseline has 'self.features', use 'self.features')",
      "4. Use REAL line numbers from the baseline code above",
      "",
      "=== OUTPUT FORMAT ===",
      "Generate exactly 3 XML tags:",
      "",
      "<hp>",
      "{{\"batch\": 64, \"lr\": 0.01, \"momentum\": 0.9}}",
      "</hp>",
      "",
      "<tr>",
      "import torchvision.transforms as transforms",
      "def transform(norm):",
      "    return transforms.Compose([transforms.Resize(32), transforms.ToTensor(), transforms.Normalize(*norm)])",
      "</tr>",
      "",
      "<delta>",
      "--- baseline.py",
      "+++ improved.py",
      "@@ -X,Y +X,Y @@",
      " <context line from baseline>",
      "+<your addition using baseline's actual variable names>",
      " <context line from baseline>",
      "</delta>",
      "",
      "=== CRITICAL RULES ===",
      "- Read baseline FIRST, then generate delta that matches ITS structure",
      "- If baseline has 'self.features', use 'self.features' (NOT 'self.conv1')",
      "- If baseline has 'AirUnit', use 'AirUnit' (NOT generic names)",
      "- Line numbers must match the actual baseline line numbers",
      "- If you add 'self.X' in forward(), you MUST add 'self.X = nn.XXX()' in __init__()",
      "- Keep train_setup(self, prm) and learn(self, train_data) unchanged"
    ],
    "output": [
      "<hp>{addon_prm}</hp>",
      "<tr>{addon_transform_code}</tr>",
      "<delta>{computed_delta}</delta>"
    ]
  }
}
